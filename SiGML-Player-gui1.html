<!-- Â© 2025 SIGNMitra Team: Dev Shah, Ayushi Soni, Maitriba Jadeja, Vishwa Joshi -->
<!DOCTYPE html>
<html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

	<title>SiGML Signing App New Gui: vhg.2021</title>

	<meta http-equiv="Access-Control-Allow-Methods" content="GET">

	<!-- CWA @ vhg.cmp.uea.ac.uk/tech/jas/vhg2021 -->

	<link rel="stylesheet" href="cwasa.css" />
	<link rel="stylesheet" href="cwapp.css" />
	<script type="text/javascript" src="allcsa.js"></script>
	<script type="text/javascript" src="split-grid.js"></script>
	
	<style>
		button {
			padding: 10px;
			background-color: #b8bfd1;
			color: #000000;
			border: none;
			border-radius: 45px;
			cursor: pointer;
			font-weight: 550;
		}

		button:hover {
			background-color: #768ed7;
		}

		#micBtn {
			font-size: 20px;
		}

		#input-section {
			display: flex;
			align-items: center;
			width: 98%;
			background: white;
			padding: 10px;
			border-radius: 10px;
			box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
			position: fixed;
			bottom: 120px;
			transform: translateY(-150%);
			/* Adjust based on keyboard height */
		}

		#glossInput {
			flex: 1;
			padding: 12px;
			font-size: 16px;
			border-radius: 10px;
			border: 1px solid #ccc;
		}


		#gujaratiKeyboard {
			display: flex;
			flex-wrap: wrap;
			justify-content: center;
			gap: 2px;
			background: white;
			padding: 5px;
			border-radius: 10px;
			box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
			position: fixed;
			bottom: 10px;
			/* Keyboard stays below the text input */
			width: 90%;
			max-width: 600px;
			margin-top: 50%;
			transform: translateX(66%);
		}


		#gujaratiKeyboard button {
			padding: 10px;
			font-size: 18px;
			font-weight: 550;
			background-color: #b8bfd1;
			color: black;
			border: 1px solid #ccc;
			border-radius: 5px;
			cursor: pointer;
			width: 40px;
			height: 40px;
		}


		#gujaratiKeyboard button:hover {
			background-color: #768ed7;
		}

		#suggestionsBox {
			display: grid;
			grid-auto-flow: column;
			justify-content: start;
			gap: 2px;
			position: absolute;
			left: 105%;
			/* Places it to the right of the keyboard */
			top: 0;
			background: white;
			padding: 5px;
			border-radius: 10px;
			box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
			width: auto;
			max-width: 300px;
		}

		#suggestionsBox button {
			padding: 10px;
			/* display: grid;
			grid-auto-flow: column; */
			font-size: 16px;
			font-weight: 550;
			background-color: #b8bfd1;
			color: black;
			border: 1px solid #ccc;
			border-radius: 5px;
			cursor: pointer;
		}

		#suggestionsBox button:hover {
			background-color: #768ed7;
		}

		#playBtn {
			padding: 12px;
			background: #2c3557;
			border: none;
			border-radius: 50%;
			color: #fff;
			font-size: 18px;
			margin-left: 0.5%;
		}

		#playBtn:hover {
			background-color: #768ed7;
			color: rgb(23, 23, 58);
		}

		#glossInput {
			flex: 1;
			padding: 12px;
			font-size: 16px;
			border-radius: 10px;
			border: 1px solid #ccc;
			margin-right: 10px;
		}
	</style>

</head>

<body onload="CWASA.init();" style="margin:0; font-family:sans-serif; background:#f8f8f8;">
	<h1 style="color: #235185;font-weight: bolder; text-align: center;">SignMitra</h1>

	<!-- Avatar View -->
	<div id="avatar-container"
		style="display:flex; flex-direction:column; align-items:center; justify-content:center; height:70vh;">
		<div class="CWASAAvatar av0" style="width:100%; height:100%; background:#fff;"></div>
	</div>

	<!-- Input Section -->
	<div id="input-section"
		style="padding:10px; display:flex; justify-content:space-between; align-items:center; background:#fff; box-shadow:0 -1px 5px rgba(0,0,0,0.1);">
		<input type="text" id="glossInput" placeholder="Type to translate" tabindex="0">
		<div class="input-controls">
			<button id="micBtn" onclick="startSpeechRecognition()">ğŸ¤</button>
		</div>
		<button id="playBtn" class="bttnPlaySiGMLText av0">â–¶</button>
	</div>
	<div id="gujaratiKeyboard">
		<!-- Vowels (àª¸à«àªµàª°) -->
		<button onclick="insertGujarati('àª…')">àª…</button>
		<button onclick="insertGujarati('àª†')">àª†</button>
		<button onclick="insertGujarati('àª‡')">àª‡</button>
		<button onclick="insertGujarati('àªˆ')">àªˆ</button>
		<button onclick="insertGujarati('àª‰')">àª‰</button>
		<button onclick="insertGujarati('àªŠ')">àªŠ</button>
		<button onclick="insertGujarati('àª')">àª</button>
		<button onclick="insertGujarati('àª')">àª</button>
		<button onclick="insertGujarati('àª“')">àª“</button>
		<button onclick="insertGujarati('àª”')">àª”</button>
		<button onclick="insertGujarati('àª‹')">àª‹</button>

		<!-- Consonants (àªµà«àª¯àª‚àªœàª¨) -->
		<button onclick="insertGujarati('àª•')">àª•</button>
		<button onclick="insertGujarati('àª–')">àª–</button>
		<button onclick="insertGujarati('àª—')">àª—</button>
		<button onclick="insertGujarati('àª˜')">àª˜</button>
		<button onclick="insertGujarati('àª™')">àª™</button>

		<button onclick="insertGujarati('àªš')">àªš</button>
		<button onclick="insertGujarati('àª›')">àª›</button>
		<button onclick="insertGujarati('àªœ')">àªœ</button>
		<button onclick="insertGujarati('àª')">àª</button>
		<button onclick="insertGujarati('àª')">àª</button>

		<button onclick="insertGujarati('àªŸ')">àªŸ</button>
		<button onclick="insertGujarati('àª ')">àª </button>
		<button onclick="insertGujarati('àª¡')">àª¡</button>
		<button onclick="insertGujarati('àª¢')">àª¢</button>
		<button onclick="insertGujarati('àª£')">àª£</button>

		<button onclick="insertGujarati('àª¤')">àª¤</button>
		<button onclick="insertGujarati('àª¥')">àª¥</button>
		<button onclick="insertGujarati('àª¦')">àª¦</button>
		<button onclick="insertGujarati('àª§')">àª§</button>
		<button onclick="insertGujarati('àª¨')">àª¨</button>

		<button onclick="insertGujarati('àªª')">àªª</button>
		<button onclick="insertGujarati('àª«')">àª«</button>
		<button onclick="insertGujarati('àª¬')">àª¬</button>
		<button onclick="insertGujarati('àª­')">àª­</button>
		<button onclick="insertGujarati('àª®')">àª®</button>

		<button onclick="insertGujarati('àª¯')">àª¯</button>
		<button onclick="insertGujarati('àª°')">àª°</button>
		<button onclick="insertGujarati('àª²')">àª²</button>
		<button onclick="insertGujarati('àªµ')">àªµ</button>

		<button onclick="insertGujarati('àª¶')">àª¶</button>
		<button onclick="insertGujarati('àª·')">àª·</button>
		<button onclick="insertGujarati('àª¸')">àª¸</button>
		<button onclick="insertGujarati('àª¹')">àª¹</button>

		<button onclick="insertGujarati('àª³')">àª³</button>
		<button onclick="insertGujarati('àª•à«àª·')">àª•à«àª·</button>
		<button onclick="insertGujarati('àªœà«àª')">àªœà«àª</button>
		<button onclick="insertGujarati('àª¤à«àª°')">àª¤à«àª°</button>

		<!-- Special Characters -->
		<button onclick="insertGujarati('àª‚')">àª‚</button>
		<button onclick="insertGujarati('àªƒ')">àªƒ</button>
		<button onclick="insertGujarati('à«')">à«</button>
		<button onclick="insertGujarati('à«')">à«</button>
		<button onclick="insertGujarati('à«¦')">à«¦</button>
		<button onclick="insertGujarati('à«§')">à«§</button>
		<button onclick="insertGujarati('à«¨')">à«¨</button>
		<button onclick="insertGujarati('à«©')">à«©</button>
		<button onclick="insertGujarati('à«ª')">à«ª</button>
		<button onclick="insertGujarati('à««')">à««</button>
		<button onclick="insertGujarati('à«¬')">à«¬</button>
		<button onclick="insertGujarati('à«­')">à«­</button>
		<button onclick="insertGujarati('à«®')">à«®</button>
		<button onclick="insertGujarati('à«¯')">à«¯</button>
		<button onclick="deleteLastCharacter()">âŒ«</button>
		<button onclick="insertGujarati(' ')">âµ</button>
		<div id="suggestionsBox"></div>
	</div>

	</div>


	<!-- Bottom Navbar -->
	<!--<div id="bottom-nav"
		style="display:flex; justify-content:space-around; align-items:center; padding:10px 0; background:#fff; border-top:1px solid #ddd; position:fixed; bottom:0; width:100%;">
		<div style="color:#f77b00; font-size:14px; text-align:center;">
			<div>ğŸ”¤</div>
			<div>Translator</div>
		</div>
		<div style="color:#999; font-size:14px; text-align:center;">
			<div>ğŸ›’</div>
			<div>Store</div>
		</div>
		<div style="color:#999; font-size:14px; text-align:center;">
			<div>ğŸ‘¤</div>
			<div>Account</div>
		</div>
	</div>-->

	<!-- Hidden SiGML Textarea -->
	<textarea class="txtaSiGMLText av0" style="display:none;"></textarea>

	<script>
		document.addEventListener("DOMContentLoaded", function () {
			const playButton = document.getElementById("playBtn");
			const glossInput = document.getElementById("glossInput");
			const micBtn = document.getElementById("micBtn");
			const sigmlTextArea = document.querySelector(".txtaSiGMLText");



			// Function to handle speech recognition input
			function startSpeechRecognition() {
				if (!("webkitSpeechRecognition" in window || "SpeechRecognition" in window)) {
					alert("Speech recognition is not supported in this browser. Use Google Chrome.");
					return;
				}

				const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
				recognition.lang = "gu-IN"; // Gujarati language

				recognition.onstart = () => {
					console.log("Listening...");
					micBtn.innerText = "ğŸ™ï¸"; // Change icon to indicate listening
				};

				recognition.onresult = (event) => {
					const speechText = event.results[0][0].transcript;
					console.log("Recognized:", speechText);

					if (glossInput) {
						glossInput.value = speechText;
					} else {
						console.error("glossInput not found!");
					}

					generateSuggestions(speechText); // Ensure this function exists
				};

				recognition.onerror = (event) => {
					console.error("Error:", event.error);
					alert("Speech Recognition Error: " + event.error);
				};

				recognition.onend = () => {
					console.log("Speech recognition ended.");
					micBtn.innerText = "ğŸ¤"; // Reset icon
				};

				recognition.start();
			}

			// Attach function to the button
			micBtn.addEventListener("click", startSpeechRecognition);

			// Function to insert Gujarati characters into the text input
			// Ensure focus when clicked
			glossInput.addEventListener("focus", function () {
				glossInput.setAttribute("autofocus", true);
			});

			// Function to insert Gujarati characters
			window.insertGujarati = function (character) {
				const textInput = document.getElementById("glossInput");
				textInput.value += character;
				generateSuggestions(textInput.value);
			};

			// Detect manual typing
			glossInput.addEventListener("input", function () {
				generateSuggestions(glossInput.value);
			});

			// Function to generate Barakhadi suggestions
			window.generateSuggestions = function (inputText) {
				const suggestionsBox = document.getElementById("suggestionsBox");
				suggestionsBox.innerHTML = "";

				const barakhadiMap = {
					"àª•": ["àª•", "àª•àª¾", "àª•àª¿", "àª•à«€", "àª•à«", "àª•à«‚", "àª•à«ƒ", "àª•à«‡", "àª•à«ˆ", "àª•à«‹", "àª•à«Œ"],
					"àª–": ["àª–", "àª–àª¾", "àª–àª¿", "àª–à«€", "àª–à«", "àª–à«‚", "àª–à«ƒ", "àª–à«‡", "àª–à«ˆ", "àª–à«‹", "àª–à«Œ"],
					"àª—": ["àª—", "àª—àª¾", "àª—àª¿", "àª—à«€", "àª—à«", "àª—à«‚", "àª—à«ƒ", "àª—à«‡", "àª—à«ˆ", "àª—à«‹", "àª—à«Œ"],
					"àª˜": ["àª˜", "àª˜àª¾", "àª˜àª¿", "àª˜à«€", "àª˜à«", "àª˜à«‚", "àª˜à«ƒ", "àª˜à«‡", "àª˜à«ˆ", "àª˜à«‹", "àª˜à«Œ"],
					"àª™": ["àª™", "àª™àª¾", " àª™àª¿", "àª™à«€", "àª™à«", "àª™à«‚", "àª™à«ƒ", "àª™à«‡", "àª™à«ˆ", "àª™à«‹", "àª™à«Œ"],
					"àªš": ["àªš", "àªšàª¾", "àªšàª¿", "àªšà«€", "àªšà«", "àªšà«‚", "àªšà«ƒ", "àªšà«‡", "àªšà«ˆ", "àªšà«‹", " àªšà«Œ"],
					"àª›": ["àª›", "àª›àª¾", "àª›àª¿", "àª›à«€", "àª›à«", "àª›à«‚", "àª›à«ƒ", "àª›à«‡", "àª›à«ˆ", "àª›à«‹", "àª›à«Œ"],
					"àªœ": ["àªœ", "àªœàª¾", "àªœàª¿", "àªœà«€", "àªœà«", "àªœà«‚", "àªœà«ƒ", "àªœà«‡", "àªœà«ˆ", "àªœà«‹", "àªœà«Œ"],
					"àª": ["àª", "àªàª¾", "àªàª¿", "àªà«€", "àªà«", "àªà«‚", "àªà«ƒ", "àªà«‡", "àªà«ˆ", "àªà«‹", "àªà«Œ"],
					"àª": ["àª", "àªàª¾", "àªàª¿", "àªà«€", "àªà«", "àªà«‚", "àªà«ƒ", "àªà«‡", "àªà«ˆ", "àªà«‹", "àªà«Œ"],
					"àªŸ": ["àªŸ", "àªŸàª¾", "àªŸàª¿", "àªŸà«€", "àªŸà«", "àªŸà«‚", "àªŸà«ƒ", "àªŸà«‡", "àªŸà«ˆ", "àªŸà«‹", "àªŸà«Œ"],
					"àª ": ["àª ", "àª àª¾", "àª àª¿", "àª à«€", "àª à«", "àª à«‚", "àª à«ƒ", "àª à«‡", "àª à«ˆ", "àª à«‹", "àª à«Œ"],
					"àª¡": ["àª¡", "àª¡àª¾", "àª¡àª¿", "àª¡à«€", "àª¡à«", "àª¡à«‚", "àª¡à«ƒ", "àª¡à«‡", "àª¡à«ˆ", "àª¡à«‹", "àª¡à«Œ"],
					"àª¢": ["àª¢", "àª¢àª¾", "àª¢àª¿", "àª¢à«€", "àª¢à«", "àª¢à«‚", "àª¢à«ƒ", "àª¢à«‡", "àª¢à«ˆ", "àª¢à«‹", "àª¢à«Œ"],
					"àª£": ["àª£", "àª£àª¾", "àª£àª¿", "àª£à«€", "àª£à«", "àª£à«‚", "àª£à«ƒ", "àª£à«‡", "àª£à«ˆ", "àª£à«‹", "àª£à«Œ"],
					"àª¤": ["àª¤", "àª¤àª¾", "àª¤àª¿", "àª¤à«€", "àª¤à«", "àª¤à«‚", "àª¤à«ƒ", "àª¤à«‡", "àª¤à«ˆ", "àª¤à«‹", "àª¤à«Œ"],
					"àª¥": ["àª¥", "àª¥àª¾", "àª¥àª¿", "àª¥à«€", "àª¥à«", "àª¥à«‚", "àª¥à«ƒ", "àª¥à«‡", "àª¥à«ˆ", "àª¥à«‹", "àª¥à«Œ"],
					"àª¦": ["àª¦", "àª¦àª¾", "àª¦àª¿", "àª¦à«€", "àª¦à«", "àª¦à«‚", "àª¦à«ƒ", "àª¦à«‡", "àª¦à«ˆ", "àª¦à«‹", "àª¦à«Œ"],
					"àª§": ["àª§", "àª§àª¾", "àª§àª¿", "àª§à«€", "àª§à«", "àª§à«‚", "àª§à«ƒ", "àª§à«‡", "àª§à«ˆ", "àª§à«‹", "àª§à«Œ"],
					"àª¨": ["àª¨", "àª¨àª¾", "àª¨àª¿", "àª¨à«€", "àª¨à«", "àª¨à«‚", "àª¨à«ƒ", "àª¨à«‡", "àª¨à«ˆ", "àª¨à«‹", "àª¨à«Œ"],
					"àªª": ["àªª", "à¤ªà¤¾", "àªªàª¿", "àªªà«€", "àªªà«", "àªªà«‚", "àªªà«ƒ", "àªªà«‡", "àªªà«ˆ", "àªªà«‹", "àªªà«Œ"],
					"àª«": ["àª«", "àª«àª¾", "àª«àª¿", "àª«à«€", "àª«à«", "àª«à«‚", "àª«à«ƒ", "àª«à«‡", "àª«à«ˆ", "àª«à«‹", "àª«à«Œ"],
					"àª¬": ["àª¬", "àª¬àª¾", "àª¬àª¿", "àª¬à«€", "àª¬à«", "àª¬à«‚", "àª¬à«ƒ", "àª¬à«‡", "àª¬à«ˆ", "àª¬à«‹", "àª¬à«Œ"],
					"àª­": ["àª­", "àª­àª¾", "àª­àª¿", "àª­à«€", "àª­à«", "àª­à«‚", "àª­à«ƒ", "àª­à«‡", "àª­à«ˆ", "àª­à«‹", "àª­à«Œ"],
					"àª®": ["àª®", "àª®àª¾", "àª®àª¿", "àª®à«€", "àª®à«", "àª®à«‚", "àª®à«ƒ", "àª®à«‡", "àª®à«ˆ", "àª®à«‹", "àª®à«Œ"],
					"àª¯": ["àª¯", "àª¯àª¾", "àª¯àª¿", "àª¯à«€", "àª¯à«", "àª¯à«‚", "àª¯à«ƒ", "àª¯à«‡", "àª¯à«ˆ", "àª¯à«‹", "àª¯à«Œ"],
					"àª°": ["àª°", "àª°àª¾", "àª°àª¿", "àª°à«€", "àª°à«", "àª°à«‚", "àª°à«ƒ", "àª°à«‡", "àª°à«ˆ", "àª°à«‹", "àª°à«Œ"],
					"àª²": ["àª²", "àª²àª¾", "àª²àª¿", "àª²à«€", "àª²à«", "àª²à«‚", "àª²à«ƒ", "àª²à«‡", "àª²à«ˆ", "àª²à«‹", "àª²à«Œ"],
					"àªµ": ["àªµ", "àªµàª¾", "àªµàª¿", "àªµà«€", "àªµà«", "àªµà«‚", "àªµà«ƒ", "àªµà«‡", "àªµà«ˆ", "àªµà«‹", "àªµà«Œ"],
					"àª¶": ["àª¶", "àª¶àª¾", "àª¶àª¿", "àª¶à«€", "àª¶à«", "àª¶à«‚", "àª¶à«ƒ", "àª¶à«‡", "àª¶à«ˆ", "àª¶à«‹", "àª¶à«Œ"],
					"àª·": ["àª·", "àª·àª¾", "àª·àª¿", "àª·à«€", "àª·à«", "àª·à«‚", "àª·à«ƒ", "àª·à«‡", "àª·à«ˆ", "àª·à«‹", "àª·à«Œ"],
					"àª¸": ["àª¸", "àª¸àª¾", "àª¸àª¿", "àª¸à«€", "àª¸à«", "àª¸à«‚", "àª¸à«ƒ", "àª¸à«‡", "àª¸à«ˆ", "àª¸à«‹", "àª¸à«Œ"],
					"àª¹": ["àª¹", "àª¹àª¾", "àª¹àª¿", "àª¹à«€", "àª¹à«", "àª¹à«‚", "àª¹à«ƒ", "àª¹à«‡", "àª¹à«ˆ", "àª¹à«‹", "àª¹à«Œ"],
					"àª³": ["àª³", "àª³àª¾", "àª³àª¿", "àª³à«€", "àª³à«", "àª³à«‚", "àª³à«ƒ", "àª³à«‡", "àª³à«ˆ", "àª³à«‹", "àª³à«Œ"],
					"àª•à«àª·": ["àª•à«àª·", "àª•à«àª·àª¾", "àª•à«àª·àª¿", "àª•à«àª·à«€", "àª•à«àª·à«", "àª•à«àª·à«‚", "àª•à«àª·à«ƒ", "àª•à«àª·à«‡", "àª•à«àª·à«ˆ", "àª•à«àª·à«‹", "àª•à«àª·à«Œ"],
					"àªœà«àª": ["àªœà«àª", "àªœà«àªàª¾", "àªœà«àªàª¿", "àªœà«àªà«€", "àªœà«àªà«", "àªœà«àªà«‚", "àªœà«àªà«ƒ", "àªœà«àªà«‡", "àªœà«àªà«ˆ", "àªœà«àªà«‹", "àªœà«àªà«Œ"],
					"àª¤à«àª°": ["àª¤à«àª°", "àª¤à«àª°àª¾", "àª¤à«àª°àª¿", "àª¤à«àª°à«€", "àª¤à«àª°à«", "àª¤à«àª°à«‚", "àª¤à«àª°à«ƒ", "àª¤à«àª°à«‡", "àª¤à«àª°à«ˆ", "àª¤à«àª°à«‹", "àª¤à«àª°à«Œ"]
				};

				const lastChar = inputText.slice(-1);
				if (barakhadiMap[lastChar]) {
					barakhadiMap[lastChar].forEach(suggestion => {
						const suggestionBtn = document.createElement("button");
						suggestionBtn.textContent = suggestion;
						suggestionBtn.onclick = () => {
							document.getElementById("glossInput").value += suggestion.slice(1);
							generateSuggestions(document.getElementById("glossInput").value);
						};
						suggestionsBox.appendChild(suggestionBtn);
					});
				}
			}
			// Function to delete the last character from the input field
			window.deleteLastCharacter = function () {
				const textInput = document.getElementById("glossInput");
				textInput.value = textInput.value.slice(0, -1); // Remove the last character
				generateSuggestions(textInput.value); // Update suggestions after deleting a character
			};
			// Function to play a single SiGML string
			const playSiGML = (sigml) => {
				return new Promise((resolve) => {
					sigmlTextArea.value = sigml;
					const playEvent = new Event('click', { bubbles: true });
					document.querySelector(".bttnPlaySiGMLText.av0").dispatchEvent(playEvent);

					// Assume average sign length ~2 seconds (you can fine-tune this)
					setTimeout(resolve, 2000);
				});
			};

			playButton.addEventListener("click", async () => {
				const words = glossInput.value.trim().split(/\s+/);
				if (!words.length) return;

				const allSigmls = [];

				for (const word of words) {
					try {
						const response = await fetch(`http://localhost:3000/api/fallback-sigml/${encodeURIComponent(word)}`);
						if (response.ok) {
							const data = await response.json();
							allSigmls.push(...data.sigmls);
						} else {
							console.warn(`âŒ Word not found: ${word}`);
						}
					} catch (err) {
						console.error(`âŒ Error fetching: ${word}`, err);
					}
				}

				glossInput.value = "";

				for (const sigml of allSigmls) {
					await playSiGML(sigml);
				}

				sigmlTextArea.value = "";
			});


		});
	</script>




</body>


</html>